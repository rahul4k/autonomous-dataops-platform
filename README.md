# Autonomous DataOps Platform

An **AI-powered, self-healing DataOps platform** that uses autonomous agents to:

- Read and interpret pipeline logs
- Detect root causes of failure
- Generate optimized code fixes
- Open GitHub Pull Requests automatically
- Notify stakeholders across Slack/Email

This project demonstrates how large language models (LLMs), observability signals, and orchestration systems like Airflow can enable **autonomous data engineering workflows**.

---

## ğŸ“Œ Key Features

### ğŸ¤– Agentic Services

- **Log Reader Agent**: Extracts anomalies, regex patterns, and error signatures from logs
- **Root-Cause Analysis Agent**: Maps log patterns to known failure classes
- **Fixer/Optimizer Agent**: Generates improved Spark code using error context
- **PR Generator Agent**: Integrates with GitHub to push fixes automatically
- **Notifier Agent**: Sends alerts with RCA + recommended actions

### ğŸ“¡ Pipeline Automation

- Sample **Airflow DAG**
- Sample **PySpark job (buggy)** and **fixed version (generated by agent)**

### â˜ï¸ Cloud Setup (GCP)

Terraform templates for:

- Artifact Registry
- Cloud Composer (Airflow)
- GCS buckets
- Cloud Run (for agents)
- Service Accounts + IAM

---

## ğŸ§  Architecture

See `/docs/architecture.md` for detailed system design.

**High-level overview:**

- Failure events are captured from Airflow/Dataproc and routed to specialized agents
- Agents parse logs, classify errors, extract signals, and validate issues (skew, OOM, shuffle)
- Automated code fixes are applied via AST-based transformations
- GitHub PRs are created automatically with human review required before merge
- Stakeholders are notified via Slack/Email with RCA summaries

---

## ğŸ§ª Tests

Unit and integration tests provided for each agent.

---

## ğŸš€ Getting Started

```bash
git clone https://github.com/rahul4k/autonomous-dataops-platform.git
cd autonomous-dataops-platform
```

---

## ğŸ“ Component Breakdown

### 1. **Production Pipelines**
Distributed Spark pipelines running on Dataproc/EMR/Glue. Trigger failure events on retries/exhaustion.

### 2. **Failure Event Producer**
Airflow failure callback that writes event.json with dag_id, task_id, log_url, and local_log_path.

### 3. **Event Orchestrator**
Simple local Python orchestrator (or Pub/Sub/Kafka) that dispatches events to agents.

### 4. **Log Reader Agent**
Performs regex + structured log parsing. Detects error classes:
- OOM (Out of Memory)
- Schema mismatches
- Data skew
- Missing files
- Py4J errors
- SparkException

Outputs log_summary.json.

### 5. **Root Cause Agent**
Applies rule-based RCA + heuristics. Infers fixes such as:
- Broadcast join optimization
- Repartitioning strategy
- Column renaming
- Executor memory adjustment
- Schema drift fixes

### 6. **Spark Metrics Agent**
Pulls Spark History Server API JSON. Detects:
- Stage retries
- Task failures
- Stragglers
- Skew ratios
- OOM signals
- Shuffle blowups

### 7. **Fixer / Optimizer Agent**
Uses AST-based code modification (libcst) for safe, deterministic transformations:
- Add `broadcast()` calls
- Insert `.repartition()` operations
- Add `withColumnRenamed()` transformations
- Insert configuration hints

### 8. **Fix â†’ PR Orchestrator**
Creates a branch, commits patched code, and generates a draft PR with:
- Patch diff
- RCA summary
- Explainability notes
- Confidence score

### 9. **Notification Agent**
Posts PR URL + summary to Slack/Teams/Email for stakeholder review.

---

## ğŸ—ï¸ System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Production Pipelines                â”‚
â”‚ (Airflow / Dataproc / Glue / EMR)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”‚ Job Fails
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Failure Event Producer                   â”‚
â”‚ (Push event: log_path, job_id, etc.)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ADP Event Orchestrator                   â”‚
â”‚ (Pub/Sub or Kafka or local scheduler)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
        â”‚       â”‚       â”‚
        â–¼       â–¼       â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Log      â”‚ â”‚ Root Cause  â”‚ â”‚ Spark        â”‚
  â”‚ Reader   â”‚ â”‚ Agent       â”‚ â”‚ Metrics      â”‚
  â”‚ Agent    â”‚â”€â–¶â”‚ Identify    â”‚â”€â–¶â”‚ Agent        â”‚
  â”‚          â”‚ â”‚ error type  â”‚ â”‚ Validate     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ RCA          â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Fixer / Code Optimizer Agent â”‚
      â”‚ (AST-based safe transforms)  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Fix â†’ PR Orchestrator    â”‚
        â”‚ Create branch, commit,   â”‚
        â”‚ open PR                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ GitHub / GitLab PR          â”‚
        â”‚ Human review + merge       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Slack / Teams / Email      â”‚
        â”‚ Notification               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š How It Works

1. **Detect**: A production pipeline fails, and failure events are captured
2. **Diagnose**: Log Reader, Root Cause, and Metrics agents analyze the issue
3. **Fix**: Fixer Agent generates safe code transformations
4. **Propose**: PR Orchestrator creates a draft GitHub PR with explanations
5. **Notify**: Notification Agent alerts stakeholders
6. **Review**: Human reviewer validates and merges the PR

---

## ğŸ¯ Real-World Application

This architecture mirrors how real SRE/DataOps automation systems work at:
- Netflix
- Uber
- Databricks

---

## ğŸ“ License

See LICENSE file for details.
